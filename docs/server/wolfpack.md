# Lupo C2 API

The Lupo Wolfpack server is a team server that is serving an API over HTTPS. The included Lupo client that is maintained by this project fully implements this API to allow multi operator use of the Lupo C2.

If for any reason you would like to write a better/different client for the Wolfpack server you can do so by following the API standard below.

## Wolfpack API
When the Wolfpack server starts an HTTPS server is created that serves an API. The primary function of this API is to proxy commands from Lupo clients so they are executed by the server to allow multi user management and collaboration across C2 activities in Lupo. All of these requests are done via HTTP GET requests.

- Available Parameters:
    - psk (REQUIRED - ALWAYS) = a string of a Pre-Shared key generated by the Lupo C2 server Wolfpack generate command. This key will be written to a JSON config file once the user is generated server side. 
    - username (REQUIRED - ALWAYS) = a string that is the username of the operator connecting to the wolfpack server. this username will be written to a JSON config file once the user is generated server side. 
    - command = a command string to be executed by the Wolfpack server. certain commands are just proxied to the server via the Grumble CLI's `RunCommand()` function while others have custom implementations based on Wolfpack specific logic. these are CLI commands, not necessarily raw commands (although all commands except local exec are processed this way)
    - polling = a boolean status indicator to inform the server if the function executed is a polling function or not. the standard client uses sub routines to constantly poll the Wolfpack server for broadcast messages. while optional, not implementing polling functions will prevent a client from receiving broadcasts messages which includes things like command output and server status changes. these messages are returned as JSON, and while the responses should remain mostly unchanged for required functions, the individual implementations of any clients will need to capture these responses and determine how to process them.
    - isSessionShell = a boolean value to indicate whether or not the current shell type being interacted with is a session or the core Lupo CLI. This is required to access session specific functions like executing commands and swapping sessions within the Wolfpack server.
    - activeSession = an integer value dictating which session is being interacted with for a given request.
    - filename = a string value provided by an implant that is the filename for a file being sent to download or upload. mostly for interacting with the upload/download commands.
    - file = a string value that is expected to be a base64 encoded string that is a file to download or upload. mostly for interacting with the upload/download commands.
    - getChatLog - boolean status to determine whether or not a user has just entered the chat to send them the full chat log.
    - isChatShell = a boolean value to indicate whether or not the current shell type being interacted with is the chat CLI or the core Lupo CLI. This is required to access the Wolfpack server chat and send/receive messages.


### GET Requests
Below is a quick sample showing how to authenticate and execute a command with the Wolfpack server. The only extra requirement might be providing a private TLS certificate from the wolfpack JSON config depending on how your TLS cert was generated.

- Example Wolpack authenticate and show sessions:
    - Request:`https://myserver:3074/?psk=<psk>&username=<username>&command=interact show`
    - Response: `{"response":"{"0":{"ID":"0","Protocol":"HTTP","ImplantArch":"Web","ImplantUpdate":"0","Rhost":"localhost:8080","RawCheckin":"2021-02-03 13:59:29.272825 -0500 EST m=+327.685513316","Checkin":"2021-02-03 13:59:29","Status":"ALIVE","Rport":"","CommandQuery":"","Query":"","RequestType":"","ShellPath":""}}"}`
